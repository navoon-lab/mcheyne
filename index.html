<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>맥체인 성경읽기 (1년 2독)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Noto Sans KR", sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 16px;
    }
    .box {
      background: #fff;
      border-radius: 18px;
      padding: 20px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.08);
    }
    .date {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 14px;
    }
    .reading {
      display: flex;
      justify-content: space-between;
      margin-bottom: 14px;
    }
    .reading div {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 1px solid #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }
    .title {
      text-align: center;
      font-size: 17px;
      margin-bottom: 12px;
    }
    .prayer {
      text-align: center;
      color: #555;
      margin-bottom: 18px;
    }
    .progress {
      text-align: center;
      font-size: 14px;
      margin-bottom: 12px;
    }
    button {
      width: 100%;
      padding: 12px;
      background: #7b61ff;
      border: none;
      color: white;
      border-radius: 12px;
      font-size: 16px;
      margin-bottom: 16px;
    }
  </style>
</head>

<body>
  <div class="box">

    <div class="date" id="today"></div>

    <div class="reading">
      <div>창</div>
      <div>마</div>
      <div>시</div>
      <div>행</div>
    </div>

    <div class="title" id="readingTitle"></div>

    <div class="prayer">
      주님께 날마다 나아가도록 도와주십시오.
    </div>

    <div class="progress" id="progress"></div>

    <button onclick="markDone()">오늘 읽기 완료</button>

  </div>

<script>
  // 서비스워커 등록
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
  }

  const today = new Date();
  const year = today.getFullYear();
  const start = new Date(year, 0, 1);
  const day = Math.floor((today - start) / 86400000);

  // 간단 예시 (실제론 365일 전체 배열)
  const plan = [
    ["창세기 1", "마태복음 1", "시편 1", "사도행전 1"]
  ];

  document.getElementById("today").innerText =
    `${year}.${today.getMonth()+1}.${today.getDate()}  오늘`;

  document.getElementById("readingTitle").innerText =
    plan[day % plan.length][0];

  const key = "mcheyne-read";
  let read = JSON.parse(localStorage.getItem(key)) || [];

  function markDone() {
    const d = today.toISOString().slice(0,10);
    if (!read.includes(d)) {
      read.push(d);
      localStorage.setItem(key, JSON.stringify(read));
      update();
    }
  }

  function update() {
    const percent = ((read.length * 2) / 730 * 100).toFixed(1);
    document.getElementById("progress").innerText =
      `올해 진행률: ${percent}%`;
  }

  update();
</script>
</body>
</html>
