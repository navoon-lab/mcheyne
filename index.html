<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>맥체인 성경읽기 (1년 2독)</title>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
      margin: 0;
      background: #f5f5f5;
    }
    .container {
      max-width: 420px;
      margin: auto;
      background: white;
      min-height: 100vh;
      padding: 20px;
    }
    h1 {
      font-size: 18px;
      margin-bottom: 10px;
    }
    .today {
      color: purple;
      cursor: pointer;
      font-size: 14px;
    }
    .circles {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
      margin: 20px 0;
    }
    .circle {
      border: 2px solid #ccc;
      border-radius: 50%;
      height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-size: 12px;
      padding: 10px;
      cursor: pointer;
    }
    .circle.done {
      background: purple;
      color: white;
      border-color: purple;
    }
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 6px;
      text-align: center;
      font-size: 13px;
    }
    .day {
      padding: 10px 0;
      border-radius: 50%;
      cursor: pointer;
    }
    .day.today {
      border: 1px solid purple;
    }
    .day.selected {
      background: purple;
      color: white;
    }
  </style>
</head>

<body>
<div class="container">

  <div style="display:flex;justify-content:space-between;">
    <h1 id="dateTitle"></h1>
    <span class="today" onclick="goToday()">오늘</span>
  </div>

  <div class="circles">
    <div class="circle" onclick="toggle(0)" id="r0"></div>
    <div class="circle" onclick="toggle(1)" id="r1"></div>
    <div class="circle" onclick="toggle(2)" id="r2"></div>
    <div class="circle" onclick="toggle(3)" id="r3"></div>
  </div>

  <p style="text-align:center;font-size:14px;">
    주님께 날마다 나아가도록 도와주십시오.
  </p>

  <div class="calendar" id="calendar"></div>

</div>

<script>
/* =========================
   맥체인 예시 데이터
   (실제 사용 시 365일까지 확장)
========================= */
const PLAN = [
  ["창 1-4 / 창 5-8", "마 1-2 / 마 3-4", "시 1-2 / 시 3-4", "행 1-2 / 행 3-4"],
  ["창 9-12 / 창 13-16", "마 5-6 / 마 7-8", "시 5-6 / 시 7-8", "행 5-6 / 행 7-8"],
  ["창 17-20 / 창 21-24", "마 9-10 / 마 11-12", "시 9-10 / 시 11-12", "행 9-10 / 행 11-12"]
];

let selected = new Date();
const state = JSON.parse(localStorage.getItem("check") || "{}");

function dayOfYear(d) {
  const start = new Date(d.getFullYear(),0,1);
  return Math.floor((d-start)/86400000);
}

function render() {
  document.getElementById("dateTitle").innerText =
    selected.toLocaleDateString("ko-KR");

  const idx = dayOfYear(selected) % PLAN.length;

  PLAN[idx].forEach((txt,i)=>{
    const el = document.getElementById("r"+i);
    el.innerText = txt;
    const key = selected.toDateString()+i;
    el.classList.toggle("done", state[key]);
  });

  renderCalendar();
}

function toggle(i){
  const key = selected.toDateString()+i;
  state[key] = !state[key];
  localStorage.setItem("check",JSON.stringify(state));
  render();
}

function goToday(){
  selected = new Date();
  render();
}

function renderCalendar(){
  const cal = document.getElementById("calendar");
  cal.innerHTML = "";
  const year = selected.getFullYear();
  const month = selected.getMonth();
  const first = new Date(year,month,1).getDay();
  const days = new Date(year,month+1,0).getDate();

  for(let i=0;i<first;i++) cal.innerHTML += "<div></div>";

  for(let d=1;d<=days;d++){
    const date = new Date(year,month,d);
    const div = document.createElement("div");
    div.innerText = d;
    div.className = "day";
    if(date.toDateString()===new Date().toDateString()) div.classList.add("today");
    if(date.toDateString()===selected.toDateString()) div.classList.add("selected");
    div.onclick=()=>{selected=date;render();}
    cal.appendChild(div);
  }
}

render();
</script>
</body>
</html>
